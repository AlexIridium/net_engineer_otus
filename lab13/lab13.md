# Лабораторная работа - Настройка протоколов CDP, LLDP и NTP

### Топология

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_00.JPG)


### Таблица адресации

| Устройство | Интерфейс | IP-адрес | Маска подсети | Шлюз по умолчанию |
| --- | --- | --- | --- | --- |
| R1 | Loopback1 | 172.16.1.1 | 255.255.255.0 | - |
| R1 | G0/0/1 | 10.22.0.1 | 255.255.255.0 | - |
| S1 | SVI VLAN 1  | 10.22.0.2 | 255.255.255.0 | 10.22.0.1 |
| S2 | SVI VLAN 1 | 10.22.0.3 | 255.255.255.0 | 10.22.0.1 |

## Задачи

### Часть 1. Создание сети и настройка основных параметров устройства

### Часть 2. Обнаружение сетевых ресурсов с помощью протокола CDP

### Часть 3. Обнаружение сетевых ресурсов с помощью протокола LLDP

### Часть 4. Настройка и проверка NTP


### Часть 1. Создание сети и настройка основных параметров устройства

В первой части лабораторной работы вам предстоит создать топологию сети и настроить основные параметры для маршрутизатора и коммутаторов.

#### Шаг 1. Создайте сеть согласно топологии.

Подключите устройства, как показано в топологии, и подсоедините необходимые кабели.

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_01.JPG)

#### Шаг 2. Настройте базовые параметры для маршрутизатора.

a.	Назначьте маршрутизатору имя устройства.

b.	Отключите поиск DNS, чтобы предотвратить попытки маршрутизатора неверно преобразовывать введенные команды таким образом, как будто они являются именами узлов.

c.	Назначьте class в качестве зашифрованного пароля привилегированного режима EXEC.

d.	Назначьте cisco в качестве пароля консоли и включите вход в систему по паролю.

e.	Назначьте cisco в качестве пароля VTY и включите вход в систему по паролю.

f.	Зашифруйте открытые пароли.

g.	Создайте баннер с предупреждением о запрете несанкционированного доступа к устройству.

h.	Настройка интерфейсов, перечисленных в таблице выше

i.	Сохраните текущую конфигурацию в файл загрузочной конфигурации.

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_02.JPG)

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_03.JPG)

#### Шаг 3. Настройте базовые параметры каждого коммутатора.

a.	Присвойте коммутатору имя устройства.

b.	Отключите поиск DNS, чтобы предотвратить попытки маршрутизатора неверно преобразовывать введенные команды таким образом, как будто они являются именами узлов.

c.	Назначьте class в качестве зашифрованного пароля привилегированного режима EXEC.

d.	Назначьте cisco в качестве пароля консоли и включите вход в систему по паролю.

e.	Назначьте cisco в качестве пароля VTY и включите вход в систему по паролю.

f.	Зашифруйте открытые пароли.

g.	Создайте баннер, который предупреждает всех, кто обращается к устройству, видит баннерное сообщение «Только авторизованные пользователи!».  

h.	Отключите неиспользуемые интерфейсы

i.	Сохраните текущую конфигурацию в файл загрузочной конфигурации.

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_04.JPG)

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_05.JPG)


#### Часть 2. Обнаружение сетевых ресурсов с помощью протокола CDP

На устройствах Cisco протокол CDP включен по умолчанию. Воспользуйтесь CDP, чтобы обнаружить порты, к которым подключены кабели.

a.	На R1 используйте соответствующую команду *show cdp*, чтобы определить, сколько интерфейсов включено CDP, сколько из них включено и сколько отключено.

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_06.JPG)



В объявлениях CDP учавствуют следующие интерфейсы: Vlan1, GigabitEthernet0/0/0, GigabitEthernet0/0/1. GigabitEthernet0/0/1 - активный интерфейс.

b.	На R1 используйте соответствующую команду show cdp, чтобы определить версию IOS, используемую на S1.

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_07.JPG)



Версия IOS на  S1 - Cisco IOS Software, C2960 Software (C2960-LANBASEK9-M), Version 15.0(2)SE4, RELEASE SOFTWARE (fc1).

c.	На S1 используйте соответствующую команду *show cdp traffic*, чтобы определить, сколько пакетов CDP было выданных.

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_08.JPG)

В данной версии Cisco PT отсутствует команда *show cdp traffic*. Взамен была использована команда *sh cdp neighbors*.

d.	Настройте SVI для VLAN 1 на S1 и S2, используя IP-адреса, указанные в таблице адресации выше. Настройте шлюз по умолчанию для каждого коммутатора на основе таблицы адресов.

S1 и S2 настроены в Части 1.

e.	На R1 выполните команду *show cdp entry S1*

Стал доступен ip адрес S1

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_06.JPG)

f.	Отключить CDP глобально на всех устройствах. 

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_09.JPG)


### Часть 3. Обнаружение сетевых ресурсов с помощью протокола LLDP

На устройствах Cisco протокол LLDP может быть включен по умолчанию. Воспользуйтесь LLDP, чтобы обнаружить порты, к которым подключены кабели.

a.	Введите соответствующую команду lldp, чтобы включить LLDP на всех устройствах в топологии.

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_10.JPG)

b.	На S1 выполните соответствующую команду lldp, чтобы предоставить подробную информацию о S2. 

Команда *show lldp entry S2* отсутствует в данной версии Cisco PT. Скрин ниже.

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_11.JPG)

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_12.JPG)

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_13.JPG)

Сhassis ID  для коммутатора S2 - это  MAC адрес интерфейса f0/1 коммутатора S2

c.	Соединитесь через консоль на всех устройствах и используйте команды LLDP, необходимые для отображения топологии физической сети только из выходных данных команды show.

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_14.JPG)

Исходя из данных на устройствах можно убедится, что топология физической сети соответствет топологии из технического задания к данной лабораторной работе. См. Часть 1, Шаг 1.

### Часть 4. Настройка NTP

В части 4 необходимо настроить маршрутизатор R1 в качестве сервера NTP, а коммутаторы S1 и S2 в качестве клиентов NTP для маршрутизатора R1. Необходимо выполнить синхронизацию времени для Syslog и отладочных функций. Если время не синхронизировано, сложно определить, какое сетевое событие стало причиной данного сообщения.

#### Шаг 1. Выведите на экран текущее время.

Введите команду show clock для отображения текущего времени на R1. Запишите отображаемые сведения о текущем времени в следующей таблице.

| Дата | Время | Часовой пояс | Источник времени |
| --- | --- | --- | --- |
| 12 Dec | 16:30:00 | UTC | Время взято из интернета |

#### Шаг 2. Установите время.

С помощью команды clock set установите время на маршрутизаторе R1. Введенное время должно быть в формате UTC. Скрин ниже.

#### Шаг 3. Настройте главный сервер NTP.

Настройте R1 в качестве хозяина NTP с уровнем слоя 4.

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_15.JPG)

#### Шаг 4. Настройте клиент NTP.

a.	Выполните соответствующую команду на S1 и S2, чтобы просмотреть настроенное время. Запишите текущее время,  в следующей таблице.

| Дата | Время | Часовой пояс |
| --- | --- | --- |
| 1 March 1993 | 3:16:49 | UTC |
| 1 March 1993 | 3:17:04 | UTC |


b.	Настройте S1 и S2 в качестве клиентов NTP. Используйте соответствующие команды NTP для получения времени от интерфейса G0/0/1 R1, а также для периодического обновления календаря или аппаратных часов коммутатора.
Скрин ниже.
Команда периодического обновления календаря или аппаратных часов коммутатора отсутствует в данной версии Cisco PT. Скрин ниже.

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_15_a.JPG)

#### Шаг 5. Проверьте настройку NTP.

a.	Используйте соответствующую команду show , чтобы убедиться, что S1 и S2 синхронизированы с R1.

Примечание. Синхронизация метки времени на маршрутизаторе R2 с меткой времени на маршрутизаторе R1 может занять несколько минут.

b.	Выполните соответствующую команду на S1 и S2, чтобы просмотреть настроенное время и сравнить ранее записанное время.

![](https://github.com/AlexIridium/net_engineer_otus/blob/main/lab13/pic_16.JPG)

Коммутаторы устновили время как на NTP сервере.


#### Вопрос для повторения

*Вопрос: Для каких интерфейсов в пределах сети не следует использовать протоколы обнаружения сетевых ресурсов? Поясните ответ.*

*Ответ: Протоколы обнаружения не следует следует применять к интерфейсам, которые "смотрят" во внешнюю сеть и могут быть использованы злоумышлинниками для для взлома вашей сети или получения секретной информации.*




